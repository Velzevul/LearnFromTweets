<script type="text/ng-template" id="menuDropdown">
    <div class="popup"
         ng-show="item.isHighlighted && !item.children.length">
        <div class="p-body">
            <div class="p-body__item">
                <tweet tweet="notification.tweet"></tweet>
            </div>
        </div>
    </div>

    <menu-popup context="item"></menu-popup>

    <div class="amd-item"
         ng-class="{'amd-item--active': item.isOpen,
                    'amd-item--parent': item.children.length,
                    'amd-item--highlighted': item.isHighlighted}"
         ng-mouseover="open(item.id)">

        <button class="amd-item__name">{{item.label}}</button>
    </div>

    <div ng-show="item.children.length">
        <div class="am-dropdown am-dropdown--nested"
             ng-show="item.isOpen">
            <div ng-repeat="item in item.children">
                <div class="am-dropdown__slot"
                     ng-hide="item.divider"
                     ng-include="'menuDropdown'"></div>

                <div class="am-dropdown__divider"
                     ng-show="item.divider"></div>
            </div>
        </div>
    </div>
</script>

<div class="app-menu">
    <ul class="l-list-inline l-list-inline--collapsed">
        <li class="l-list-inline__item"
            ng-repeat="rootItem in menu">
            <div class="app-menu__slot">
                <menu-popup context="rootItem"></menu-popup>

                <div class="am-item"
                     ng-class="{'am-item--active': rootItem.isOpen,
                                'am-item--highlighted': rootItem.isHighlighted}"
                     ng-mouseover="open(rootItem.id)">
                    <button class="am-item__name">
                        <span class="l-list-inline l-list-inline--collapsed">
                            <span class="l-list-inline__item is-middle-aligned">
                                {{rootItem.label}}
                            </span>

                            <span class="l-list-inline__item is-middle-aligned"
                                  ng-show="filters.active">
                            </span>
                        </span>
                    </button>
                </div>

                <div class="am-dropdown am-dropdown--root"
                     ng-show="rootItem.isOpen">
                    <div ng-repeat="item in rootItem.children">
                        <div class="am-dropdown__slot"
                             ng-hide="item.divider"
                             ng-include="'menuDropdown'"></div>

                        <div class="am-dropdown__divider"
                             ng-show="item.divider"></div>
                    </div>
                </div>
            </div>
        </li>
    </ul>
</div>